

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Molecules &mdash; specatalog 2025 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />

  
    <link rel="canonical" href="https://theresiaquintes.github.io/specatalog/tutorial_molecules.html" />
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=e66a8189"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Measurements" href="tutorial_measurements.html" />
    <link rel="prev" title="The organisation of the archive" href="tutorial_structure.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            specatalog
              <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="update.html">Update</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial_structure.html">The organisation of the archive</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Molecules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creation-of-a-new-entry">Creation of a new entry</a></li>
<li class="toctree-l2"><a class="reference internal" href="#query-molecules">Query molecules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#update-molecules">Update molecules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#delete-molecules">Delete molecules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_measurements.html">Measurements</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_hdf5object.html">Measurement.h5 file</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_allowed_values.html">Allowed values</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Packages</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="main.html">main</a></li>
<li class="toctree-l1"><a class="reference internal" href="crud_db.html">crud_db</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">models</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_management.html">data_management</a></li>
<li class="toctree-l1"><a class="reference internal" href="helpers.html">helpers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Administration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="admin_database.html">Database administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin_new_models.html">Adding new models</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin_new_data_loader.html">Adding new loaders</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">specatalog</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Molecules</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tutorial_molecules.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="tutorial_structure.html" class="btn btn-neutral float-left" title="The organisation of the archive" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorial_measurements.html" class="btn btn-neutral float-right" title="Measurements" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="molecules">
<h1>Molecules<a class="headerlink" href="#molecules" title="Link to this heading"></a></h1>
<p>The molecules table shall be filled with all molecules which have been measured. Therefore, the following tutorialpage focusses on the creation of molecule entries and the work with them.</p>
<section id="creation-of-a-new-entry">
<span id="tutorial-molecules-new-entry"></span><h2>Creation of a new entry<a class="headerlink" href="#creation-of-a-new-entry" title="Link to this heading"></a></h2>
<p>First of all a new entry shall be added to the molecules table.
As an example we will add anthracene and a covalently bonded pair of perylene and TEMPO.</p>
<ol class="arabic">
<li><p>Choose a group to which the molecule belongs</p>
<blockquote>
<div><p>Each molecule in the database has to be part of a group. Available are: radical pairs (RP), triplet-doublet pairs (TDP), triplet-triplet pairs (TTP) and all others (SingleMolecule). The chosen group decides which extra information are necessary for the entry. In our case anthracene is a <strong>SingleMolecule</strong>, while PER-TEMPO is a <strong>TDP</strong>.</p>
</div></blockquote>
</li>
<li><p>Design and store the files with the structural formulas.</p></li>
<li><p>Set up the MoleculeModel dependent on the chosen group from 1.</p>
<blockquote>
<div><p>The required fields for each group can be found in the documentation of the module <a class="reference internal" href="models.html#models-creation-pydantic-molecules"><span class="std std-ref">creation_pydantic_molecules</span></a>.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">specatlog.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">creation_pydantic_molecules</span> <span class="k">as</span> <span class="n">mol</span>

<span class="n">anthracene</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">TDP</span><span class="p">(</span><span class="n">molecular_formula</span><span class="o">=</span><span class="s2">&quot;C14H10&quot;</span><span class="p">,</span>
                                     <span class="n">name</span><span class="o">=</span><span class="s2">&quot;anthracene&quot;</span><span class="p">)</span>

<span class="n">per_tempo</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">TDPModel</span><span class="p">(</span><span class="n">molecular_formula</span><span class="o">=</span><span class="s2">&quot;C29H30NO&quot;</span><span class="p">,</span>
                         <span class="n">doublet</span> <span class="o">=</span> <span class="s2">&quot;NO1&quot;</span><span class="p">,</span>     <span class="c1"># name from allowed_values.py for TEMPO</span>
                         <span class="n">linker</span> <span class="o">=</span> <span class="s2">&quot;co&quot;</span><span class="p">,</span>       <span class="c1"># name from allowed_values.py for a covalent bond</span>
                         <span class="n">chromophore</span> <span class="o">=</span> <span class="s2">&quot;PER&quot;</span>  <span class="c1"># name from allowed_values.py for perylene</span>
                         <span class="p">)</span>
</pre></div>
</div>
<p>The field <code class="docutils literal notranslate"><span class="pre">molecular_formula</span></code> is necessary in all cases. The other fields are dependent on the group. The name for a SingleMolecule is freely choosable but should be unique. For the molecules of the other groups (which are always composed of two components) the names for the components have to be from the lists in allowed values to assure consistency. You should name your compounds systematically and add the names to the <code class="docutils literal notranslate"><span class="pre">allowed_values.py</span></code> as described in <a class="reference internal" href="tutorial_allowed_values.html"><span class="doc">Allowed values</span></a>. The name of the molecule is then automatically build from the names of the compounds.</p>
</div></blockquote>
</li>
<li><p>Use the function <a class="reference internal" href="generated/specatalog.crud_db.create.create_new_molecule.html#specatalog.crud_db.create.create_new_molecule" title="specatalog.crud_db.create.create_new_molecule"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_new_molecule</span></code></a> to add the entry to the table of the database:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">specatalog.crud_db</span><span class="w"> </span><span class="kn">import</span> <span class="n">create</span>

<span class="n">anthracene_db</span> <span class="o">=</span> <span class="n">create</span><span class="o">.</span><span class="n">create_new_molecule</span><span class="p">(</span><span class="n">anthracene</span><span class="p">)</span>
<span class="n">per_tempo_db</span> <span class="o">=</span> <span class="n">create</span><span class="o">.</span><span class="n">create_new_molecule</span><span class="p">(</span><span class="n">per_tempo</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Use the information from the variable <code class="docutils literal notranslate"><span class="pre">molecule_db</span></code> to copy the structural formula files to the right directory</p>
<blockquote>
<div><p>The <code class="docutils literal notranslate"><span class="pre">molecule</span></code> object contains the attributes <code class="docutils literal notranslate"><span class="pre">molecule.structural_formula</span></code> (= relative path to the folder in the archive with the structural formulas) and <code class="docutils literal notranslate"><span class="pre">molecule.name</span></code> (= name of the molecule), which can be used to save the files with the structural formulas systematically:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">specatalog.main</span><span class="w"> </span><span class="kn">import</span> <span class="n">BASE_PATH</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>

<span class="n">struct_anthracene</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">your</span><span class="o">/</span><span class="n">image</span><span class="o">/</span><span class="n">anthracene</span><span class="o">.</span><span class="n">cdxml</span><span class="o">&gt;</span>
<span class="n">target_anthracene</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_PATH</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">anthracene</span><span class="o">.</span><span class="n">structural_formula</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">anthracene</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.cdxml&quot;</span>
<span class="n">target_anthracene</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="n">Ture</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># create directory</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">struct_anthracene</span><span class="p">,</span> <span class="n">target_anthracene</span><span class="p">)</span>

<span class="n">struct_per_tempo</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">your</span><span class="o">/</span><span class="n">image</span><span class="o">/</span><span class="n">per_tempo</span><span class="o">.</span><span class="n">cdxml</span>
<span class="n">target_per_tempo</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_PATH</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">per_tempo</span><span class="o">.</span><span class="n">structural_formula</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">per_tempo</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.cdxml&quot;</span>
<span class="n">target_per_tempo</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="n">Ture</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">struct_per_tempo</span><span class="p">,</span> <span class="n">target_per_tempo</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</section>
<section id="query-molecules">
<h2>Query molecules<a class="headerlink" href="#query-molecules" title="Link to this heading"></a></h2>
<p>It is possible to filter the database for molecules with specific properties. As an example we want to query the database for all triplet-doublet pairs with covalent linkers.</p>
<ol class="arabic">
<li><p>Set up a filter model</p>
<blockquote>
<div><p>An empty filter model includes all possible fields. You can fill the model with your desired properties. All possible FilterModels and an explanation of their fields can be found <a class="reference internal" href="crud_db.html#crud-db-filtermodels"><span class="std std-ref">here</span></a>.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">specatalog.crud_db</span><span class="w"> </span><span class="kn">import</span> <span class="n">read</span> <span class="k">as</span> <span class="n">r</span>

<span class="n">covalent_linker_filter</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">TDPFilter</span><span class="p">(</span><span class="n">linker</span><span class="o">=</span><span class="s2">&quot;co&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>(Optional) Set up an ordering model</p>
<blockquote>
<div><p>If you want to sort your results you can construct an <a class="reference internal" href="crud_db.html#crud-db-orderingmodels"><span class="std std-ref">ordering model</span></a>, where you can choose for each parameter if the list of results shall be ordered ascending (<code class="docutils literal notranslate"><span class="pre">&quot;asc&quot;</span></code>) or descending (<code class="docutils literal notranslate"><span class="pre">&quot;descending&quot;`</span></code>). An OrderingModel is not required but in our example we sort the molecules with respect to the name of the chromophore in ascending order:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ordering_model</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">TDPOrdering</span><span class="p">(</span><span class="n">chromophore</span><span class="o">=</span><span class="s2">&quot;asc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Run the query using the function <a class="reference internal" href="generated/specatalog.crud_db.read.run_query.html#specatalog.crud_db.read.run_query" title="specatalog.crud_db.read.run_query"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_query</span></code></a>.</p>
<blockquote>
<div><p>Now you can run the query and print the results. The printed results have the structure: (molecular group: name, mol_id):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">run_query</span><span class="p">(</span><span class="n">covalent_linker_filter</span><span class="p">,</span> <span class="n">ordering_model</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>  <span class="c1"># print the list with all results</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>  <span class="c1"># print the mol_id of the first result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">structural_formula</span><span class="p">)</span>  <span class="c1"># print the path to the structural formula of the first result</span>
</pre></div>
</div>
<p>The function returns a list of molecule objects. You cann call the values of the attributes like the ID or the path to the structural formula.</p>
</div></blockquote>
</li>
</ol>
</section>
<section id="update-molecules">
<h2>Update molecules<a class="headerlink" href="#update-molecules" title="Link to this heading"></a></h2>
<p>If you have to change information on molecules it is possible to update the database entries. As an example you have for mistake commited the wrong structural formula to the database for the molecule with the mol_id=3 and would like to correct the entry.</p>
<ol class="arabic">
<li><p>Load the molecule</p>
<blockquote>
<div><p>We will load the entry with the ID=3 by querying the database for the molecule with id=1 and choosing the first (and only) result from the list.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">specatalog.crud_db</span><span class="w"> </span><span class="kn">import</span> <span class="n">read</span> <span class="k">as</span> <span class="n">r</span>
<span class="n">mol_3</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">run_query</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">MoleculeFilter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">3</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Build an update filter</p>
<blockquote>
<div><p>Analoguos to the models for filtering <a class="reference internal" href="crud_db.html#crud-db-updatemodels"><span class="std std-ref">UpdateModels</span></a> exist. Each attribute of an object of the class UpdateModel can be set to a new attribute (of the correct type):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">specatalog.crud_db</span><span class="w"> </span><span class="kn">import</span> <span class="n">update</span> <span class="k">as</span> <span class="n">up</span>
<span class="n">update_mol_form</span> <span class="o">=</span> <span class="n">up</span><span class="o">.</span><span class="n">MoleculeUpdate</span><span class="p">(</span><span class="n">molecular_formula</span><span class="o">=</span><span class="s2">&quot;corrected formula&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Update the database entry by using the function <a class="reference internal" href="generated/specatalog.crud_db.update.update_model.html#specatalog.crud_db.update.update_model" title="specatalog.crud_db.update.update_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">update_model</span></code></a>.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">up</span><span class="o">.</span><span class="n">update_model</span><span class="p">(</span><span class="n">mol_3</span><span class="p">,</span> <span class="n">update_mol_form</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In case of molecules consisting of two compounds the name-property is updated automatically if the name of one or more of the compounds changes.</p>
</div>
</section>
<section id="delete-molecules">
<h2>Delete molecules<a class="headerlink" href="#delete-molecules" title="Link to this heading"></a></h2>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>It is possible to delete molecules using the function <a class="reference internal" href="generated/specatalog.crud_db.delete.delete_molecule.html#specatalog.crud_db.delete.delete_molecule" title="specatalog.crud_db.delete.delete_molecule"><code class="xref py py-func docutils literal notranslate"><span class="pre">delete_molecule</span></code></a>. But it is not advised to do so! If you delete a molecule entry from a database <strong>all</strong> measurements which are assigned to this molecule will be also deleted. If you have to delete a molecule don’t forget to delete the corresponding folder in the archive directory aswell.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial_structure.html" class="btn btn-neutral float-left" title="The organisation of the archive" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorial_measurements.html" class="btn btn-neutral float-right" title="Measurements" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025 Theresia Quintes.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>